#!/usr/bin/env node
var program = require('commander');
var pkg = require('../package.json');
var globsync = require('glob-whatev');
var compiler = require('../lib');

program.version(pkg.version)
	.usage('[options] <files ...>')
	.description(pkg.description)
	.option('-o, --out [name]', 'The output file (default: views.js)', 'views.js')
	.parse(process.argv);

var files = [];
program.args.forEach(function(pattern) {
  files = files.concat(globsync.glob(pattern));
});

files.forEach(function(file) {
  console.log('Adding ' + file);
});

compiler(files, program, function(err, output, outfile) {
  if(err) {
    console.error('There was an error: ' + err.message);
  } else {
    console.log('Wrote compiled views to ' + outfile);
  }
});