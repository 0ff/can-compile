(function(e){"use strict";if(location.hostname==="todomvc.com"){var t=[["_setAccount","UA-31081062-1"],["_trackPageview"]];(function(e,t){var n=e.createElement(t),r=e.getElementsByTagName(t)[0];n.src="//www.google-analytics.com/ga.js",r.parentNode.insertBefore(n,r)})(document,"script")}})(window),function(window,$,undefined){var can=window.can||{};if(typeof GLOBALCAN=="undefined"||GLOBALCAN!==!1)window.can=can;can.isDeferred=function(e){var t=this.isFunction;return e&&t(e.then)&&t(e.pipe)},can.each=function(e,t,n){var r=0,i;if(e)if(typeof e.length=="number"&&e.pop){e.attr&&e.attr("length");for(i=e.length;r<i;r++)if(t.call(n||e[r],e[r],r,e)===!1)break}else if(e.hasOwnProperty)for(i in e)if(e.hasOwnProperty(i)&&t.call(n||e[i],e[i],i,e)===!1)break;return e},$.extend(can,$,{trigger:function(e,t,n){e.trigger?e.trigger(t,n):$.event.trigger(t,n,e,!0)},addEvent:function(e,t){return $([this]).bind(e,t),this},removeEvent:function(e,t){return $([this]).unbind(e,t),this},buildFragment:function(e,t){var n=$.buildFragment([e],$(t));return n.cacheable?$.clone(n.fragment):n.fragment},$:$,each:can.each}),$.each(["bind","unbind","undelegate","delegate"],function(e,t){can[t]=function(){var e=this[t]?this:$([this]);return e[t].apply(e,arguments),this}}),$.each(["append","filter","addClass","remove","data","get"],function(e,t){can[t]=function(e){return e[t].apply(e,can.makeArray(arguments).slice(1))}});var oldClean=$.cleanData;$.cleanData=function(e){$.each(e,function(e,t){t&&can.trigger(t,"destroyed",[],!1)}),oldClean(e)};var undHash=/_|-/,colons=/\=\=/,words=/([A-Z]+)([A-Z][a-z])/g,lowUp=/([a-z\d])([A-Z])/g,dash=/([a-z\d])([A-Z])/g,replacer=/\{([^\}]+)\}/g,quote=/"/g,singleQuote=/'/g,getNext=function(e,t,n){return t in e?e[t]:n&&(e[t]={})},isContainer=function(e){return/^f|^o/.test(typeof e)};can.extend(can,{esc:function(e){var t=e===null||e===undefined||isNaN(e)&&""+e=="NaN";return(""+(t?"":e)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(quote,"&#34;").replace(singleQuote,"&#39;")},getObject:function(e,t,n){var r=e?e.split("."):[],i=r.length,s,o=0,u,a;t=can.isArray(t)?t:[t||window];if(!i)return t[0];while(t[o]){s=t[o];for(a=0;a<i-1&&isContainer(s);a++)s=getNext(s,r[a],n);if(isContainer(s)){u=getNext(s,r[a],n);if(u!==undefined)return n===!1&&delete s[r[a]],u}o++}},capitalize:function(e,t){return e.charAt(0).toUpperCase()+e.slice(1)},underscore:function(e){return e.replace(colons,"/").replace(words,"$1_$2").replace(lowUp,"$1_$2").replace(dash,"_").toLowerCase()},sub:function(e,t,n){var r=[];return r.push(e.replace(replacer,function(e,i){var s=can.getObject(i,t,n===undefined?n:!n);return s===undefined?(r=null,""):isContainer(s)&&r?(r.push(s),""):""+s})),r===null?r:r.length<=1?r[0]:r},replacer:replacer,undHash:undHash});var initializing=0;can.Construct=function(){if(arguments.length)return can.Construct.extend.apply(can.Construct,arguments)},can.extend(can.Construct,{newInstance:function(){var e=this.instance(),t=arguments,n;return e.setup&&(n=e.setup.apply(e,arguments)),e.init&&e.init.apply(e,n||arguments),e},_inherit:function(e,t,n){can.extend(n||e,e||{})},_overwrite:function(e,t,n,r){e[n]=r},setup:function(e,t){this.defaults=can.extend(!0,{},e.defaults,this.defaults)},instance:function(){initializing=1;var e=new this;return initializing=0,e},extend:function(e,t,n){function f(){if(!initializing)return this.constructor!==f&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.constructor.newInstance.apply(this.constructor,arguments)}typeof e!="string"&&(n=t,t=e,e=null),n||(n=t,t=null),n=n||{};var r=this,i=this.prototype,s,o,u,a;a=this.instance(),can.Construct._inherit(n,i,a);for(s in r)r.hasOwnProperty(s)&&(f[s]=r[s]);can.Construct._inherit(t,r,f);if(e){var l=e.split("."),o=l.pop(),c=can.getObject(l.join("."),window,!0),u=c,h=can.underscore(e.replace(/\./g,"_")),p=can.underscore(o);c[o]=f}can.extend(f,{constructor:f,prototype:a,namespace:u,shortName:o,_shortName:p,fullName:e,_fullName:h}),f.prototype.constructor=f;var d=[r].concat(can.makeArray(arguments)),v=f.setup.apply(f,d);return f.init&&f.init.apply(f,v||d),f}});var canMakeObserve=function(e){return e&&(can.isArray(e)||can.isPlainObject(e)||e instanceof can.Observe)},unhookup=function(e,t){return can.each(e,function(e){e&&e.unbind&&e.unbind("change"+t)})},hookupBubble=function(e,t,n,r,i){return r=r||Observe,i=i||Observe.List,e instanceof Observe?unhookup([e],n._cid):can.isArray(e)?e=new i(e):e=new r(e),e.bind("change"+n._cid,function(){var r=can.makeArray(arguments),i=r.shift();r[0]=(t==="*"?[n.indexOf(e),r[0]]:[t,r[0]]).join("."),i.triggeredNS=i.triggeredNS||{};if(i.triggeredNS[n._cid])return;i.triggeredNS[n._cid]=!0,can.trigger(n,i,r)}),e},observeId=0,serialize=function(e,t,n){return e.each(function(e,r){n[r]=canMakeObserve(e)&&can.isFunction(e[t])?e[t]():e}),n},$method=function(e){return function(){return can[e].apply(this,arguments)}},bind=$method("addEvent"),unbind=$method("removeEvent"),attrParts=function(e){return can.isArray(e)?e:(""+e).split(".")},batchNum=1,transactions=0,batchEvents=[],stopCallbacks=[],cid=0;can.cid=function(e,t){return e._cid?e._cid:e._cid=(t||"")+ ++cid};var Observe=can.Observe=can.Construct({bind:bind,unbind:unbind,id:"id",canMakeObserve:canMakeObserve,startBatch:function(e){transactions++,e&&stopCallbacks.push(e)},stopBatch:function(e,t){e?transactions=0:transactions--;if(transactions==0){var n=batchEvents.slice(0),r=stopCallbacks.slice(0);batchEvents=[],stopCallbacks=[],batchNum++,t&&this.startBatch(),can.each(n,function(e){can.trigger.apply(can,e)}),can.each(r,function(e){e})}},triggerBatch:function(e,t,n){if(!e._init){if(transactions==0)return can.trigger(e,t,n);batchEvents.push([e,{type:t,batchNum:batchNum},n])}},keys:function(e){var t=[];Observe.__reading&&Observe.__reading(e,"__keys");for(var n in e._data)t.push(n);return t}},{setup:function(e){this._data={},can.cid(this,".observe"),this._init=1,this.attr(e),this.bind("change"+this._cid,can.proxy(this._changes,this)),delete this._init},_changes:function(e,t,n,r,i){Observe.triggerBatch(this,{type:t,batchNum:e.batchNum},[r,i])},attr:function(e,t){var n=typeof e;return n!=="string"&&n!=="number"?this._attrs(e,t):t===undefined?(Observe.__reading&&Observe.__reading(this,e),this._get(e)):(this._set(e,t),this)},each:function(){return Observe.__reading&&Observe.__reading(this,"__keys"),can.each.apply(undefined,[this.__get()].concat(can.makeArray(arguments)))},removeAttr:function(e){var t=attrParts(e),n=t.shift(),r=this._data[n];return t.length?r.removeAttr(t):(n in this._data&&(delete this._data[n],n in this.constructor.prototype||delete this[n],Observe.triggerBatch(this,"__keys",undefined),Observe.triggerBatch(this,"change",[n,"remove",undefined,r]),Observe.triggerBatch(this,n,[undefined,r])),r)},_get:function(e){var t=attrParts(e),n=this.__get(t.shift());return t.length?n?n._get(t):undefined:n},__get:function(e){return e?this._data[e]:this._data},_set:function(e,t){var n=attrParts(e),r=n.shift(),i=this.__get(r);if(canMakeObserve(i)&&n.length)i._set(n,t);else{if(!!n.length)throw"can.Observe: Object does not exist";this.__convert&&(t=this.__convert(r,t)),i||Observe.triggerBatch(this,"__keys",undefined),this.__set(r,t,i)}},__set:function(e,t,n){if(t!==n){var r=this.__get().hasOwnProperty(e)?"set":"add";this.___set(e,canMakeObserve(t)?hookupBubble(t,e,this):t),Observe.triggerBatch(this,"change",[e,r,t,n]),n&&unhookup([n],this._cid)}},___set:function(e,t){this._data[e]=t,e in this.constructor.prototype||(this[e]=t)},bind:bind,unbind:unbind,serialize:function(){return serialize(this,"serialize",{})},_attrs:function(e,t){if(e===undefined)return serialize(this,"attr",{});e=can.extend(!0,{},e);var n,r=this,i;Observe.startBatch(),this.each(function(n,s,o){i=e[s];if(i===undefined){t&&r.removeAttr(s);return}r.__convert&&(i=r.__convert(s,i)),n!==i&&(n instanceof can.Observe&&i instanceof can.Observe&&unhookup([n],r._cid),i instanceof can.Observe?r._set(s,i):canMakeObserve(n)&&canMakeObserve(i)?n.attr(i,o):n!=i&&r._set(s,i)),delete e[s]});for(var n in e)i=e[n],this._set(n,i);return Observe.stopBatch(),this}}),splice=[].splice,list=Observe({setup:function(e,t){this.length=0,can.cid(this,".observe"),this._init=1,this.push.apply(this,can.makeArray(e||[])),this.bind("change"+this._cid,can.proxy(this._changes,this)),can.extend(this,t),delete this._init},_changes:function(e,t,n,r,i){~t.indexOf(".")||(n==="add"?(Observe.triggerBatch(this,n,[r,+t]),Observe.triggerBatch(this,"length",[this.length])):n==="remove"?(Observe.triggerBatch(this,n,[i,+t]),Observe.triggerBatch(this,"length",[this.length])):Observe.triggerBatch(this,n,[r,+t])),Observe.prototype._changes.apply(this,arguments)},__get:function(e){return e?this[e]:this},___set:function(e,t){this[e]=t,+e>=this.length&&(this.length=+e+1)},serialize:function(){return serialize(this,"serialize",[])},splice:function(e,t){var n=can.makeArray(arguments),r;for(r=2;r<n.length;r++){var i=n[r];canMakeObserve(i)&&(n[r]=hookupBubble(i,"*",this))}t===undefined&&(t=n[1]=this.length-e);var s=splice.apply(this,n);return t>0&&(Observe.triggerBatch(this,"change",[""+e,"remove",undefined,s]),unhookup(s,this._cid)),n.length>2&&Observe.triggerBatch(this,"change",[""+e,"add",n.slice(2),s]),s},_attrs:function(e,t){if(e===undefined)return serialize(this,"attr",[]);e=can.makeArray(e),Observe.startBatch(),this._updateAttrs(e,t),Observe.stopBatch()},_updateAttrs:function(e,t){var n=Math.min(e.length,this.length);for(var r=0;r<n;r++){var i=this[r],s=e[r];canMakeObserve(i)&&canMakeObserve(s)?i.attr(s,t):i!=s&&this._set(r,s)}e.length>this.length?this.push.apply(this,e.slice(this.length)):e.length<this.length&&t&&this.splice(e.length)}}),getArgs=function(e){return e[0]&&can.isArray(e[0])?e[0]:can.makeArray(e)};can.each({push:"length",unshift:0},function(e,t){list.prototype[t]=function(){var n=can.makeArray(arguments),r=e?this.length:0;for(var i=0;i<n.length;i++){var s=n[i];canMakeObserve(s)&&(n[i]=hookupBubble(s,"*",this,this.constructor.Observe,this.constructor))}var o=[][t].apply(this,n);return(!this.comparator||!n.length)&&Observe.triggerBatch(this,"change",[""+r,"add",n,undefined]),o}}),can.each({pop:"length",shift:0},function(e,t){list.prototype[t]=function(){var n=getArgs(arguments),r=e&&this.length?this.length-1:0,i=[][t].apply(this,n);return Observe.triggerBatch(this,"change",[""+r,"remove",undefined,[i]]),i&&i.unbind&&i.unbind("change"+this._cid),i}}),can.extend(list.prototype,{indexOf:function(e){return this.attr("length"),can.inArray(e,this)},join:[].join,slice:function(){var e=Array.prototype.slice.apply(this,arguments);return new this.constructor(e)},concat:function(){var e=[];return can.each(can.makeArray(arguments),function(t,n){e[n]=t instanceof can.Observe.List?t.serialize():t}),new this.constructor(Array.prototype.concat.apply(this.serialize(),e))},forEach:function(e,t){can.each(this,e,t||this)}}),Observe.List=list,Observe.setup=function(){can.Construct.setup.apply(this,arguments),this.List=Observe.List({Observe:this},{})};var pipe=function(e,t,n){var r=new can.Deferred;return e.then(function(){var e=can.makeArray(arguments);e[0]=t[n](e[0]),r.resolveWith(r,e)},function(){r.rejectWith(this,arguments)}),typeof e.abort=="function"&&(r.abort=function(){return e.abort()}),r},modelNum=0,ignoreHookup=/change.observe\d+/,getId=function(e){return can.Observe.__reading&&can.Observe.__reading(e,e.constructor.id),e.__get(e.constructor.id)},ajax=function(e,t,n,r,i,s){var o={};if(typeof e=="string"){var u=e.split(/\s/);o.url=u.pop(),u.length&&(o.type=u.pop())}else can.extend(o,e);return o.data=typeof t=="object"&&!can.isArray(t)?can.extend(o.data||{},t):t,o.url=can.sub(o.url,o.data,!0),can.ajax(can.extend({type:n||"post",dataType:r||"json",success:i,error:s},o))},makeRequest=function(e,t,n,r,i){var s,o=[e.serialize()],u=e.constructor,a;return t=="destroy"&&o.shift(),t!=="create"&&o.unshift(getId(e)),a=u[t].apply(u,o),s=a.pipe(function(n){return e[i||t+"d"](n,a),e}),a.abort&&(s.abort=function(){a.abort()}),s.then(n,r),s},ajaxMethods={create:{url:"_shortName",type:"post"},update:{data:function(e,t){t=t||{};var n=this.id;return t[n]&&t[n]!==e&&(t["new"+can.capitalize(e)]=t[n],delete t[n]),t[n]=e,t},type:"put"},destroy:{type:"delete",data:function(e){var t={};return t.id=t[this.id]=e,t}},findAll:{url:"_shortName"},findOne:{}},ajaxMaker=function(e,t){return function(n){return n=e.data?e.data.apply(this,arguments):n,ajax(t||this[e.url||"_url"],n,e.type||"get")}};can.Model=can.Observe({fullName:"can.Model",setup:function(e){this.store={},can.Observe.setup.apply(this,arguments);if(!can.Model)return;this.List=ML({Observe:this},{});var t=this,n=can.proxy(this._clean,t);can.each(ajaxMethods,function(r,i){can.isFunction(t[i])||(t[i]=ajaxMaker(r,t[i]));if(t["make"+can.capitalize(i)]){var s=t["make"+can.capitalize(i)](t[i]);can.Construct._overwrite(t,e,i,function(){this._reqs++;var e=s.apply(this,arguments),t=e.then(n,n);return t.abort=e.abort,t})}});if(t.fullName=="can.Model"||!t.fullName)t.fullName="Model"+ ++modelNum;this._reqs=0,this._url=this._shortName+"/{"+this.id+"}"},_ajax:ajaxMaker,_clean:function(){this._reqs--;if(!this._reqs)for(var e in this.store)this.store[e]._bindings||delete this.store[e];return arguments[0]},models:function(e,t){if(!e)return;if(e instanceof this.List)return e;var n=this,r=[],i=t instanceof can.Observe.List?t:new(n.List||ML),s=can.isArray(e),o=e instanceof ML,u=s?e:o?e.serialize():e.data,a=0;return i.length>0&&i.splice(0),can.each(u,function(e){r.push(n.model(e))}),i.push.apply(i,r),s||can.each(e,function(e,t){t!=="data"&&i.attr(t,e)}),i},model:function(e){if(!e)return;e instanceof this&&(e=e.serialize());var t=e[this.id],n=t&&this.store[t]?this.store[t].attr(e):new this(e);return this._reqs&&(this.store[e[this.id]]=n),n}},{isNew:function(){var e=getId(this);return!e&&e!==0},save:function(e,t){return makeRequest(this,this.isNew()?"create":"update",e,t)},destroy:function(e,t){return makeRequest(this,"destroy",e,t,"destroyed")},bind:function(e){return ignoreHookup.test(e)||(this._bindings||(this.constructor.store[getId(this)]=this,this._bindings=0),this._bindings++),can.Observe.prototype.bind.apply(this,arguments)},unbind:function(e){return ignoreHookup.test(e)||(this._bindings--,this._bindings||delete this.constructor.store[getId(this)]),can.Observe.prototype.unbind.apply(this,arguments)},___set:function(e,t){can.Observe.prototype.___set.call(this,e,t),e===this.constructor.id&&this._bindings&&(this.constructor.store[getId(this)]=this)}}),can.each({makeFindAll:"models",makeFindOne:"model"},function(e,t){can.Model[t]=function(t){return function(n,r,i){var s=pipe(t.call(this,n),this,e);return s.then(r,i),s}}}),can.each(["created","updated","destroyed"],function(e){can.Model.prototype[e]=function(t){var n,r=this.constructor;n=t&&typeof t=="object"&&this.attr(t.attr?t.attr():t),can.trigger(this,e),can.trigger(this,"change",e),can.trigger(r,e,this)}});var ML=can.Model.List=can.Observe.List({setup:function(){can.Observe.List.prototype.setup.apply(this,arguments);var e=this;this.bind("change",function(t,n){if(/\w+\.destroyed/.test(n)){var r=e.indexOf(t.target);r!=-1&&e.splice(r,1)}})}}),digitTest=/^\d+$/,keyBreaker=/([^\[\]]+)|(\[\])/g,paramTest=/([^?#]*)(#.*)?$/,prep=function(e){return decodeURIComponent(e.replace(/\+/g," "))};can.extend(can,{deparam:function(e){var t={},n,r;return e&&paramTest.test(e)&&(n=e.split("&"),can.each(n,function(e){var n=e.split("="),i=prep(n.shift()),s=prep(n.join("=")),o=t;n=i.match(keyBreaker);for(var u=0,a=n.length-1;u<a;u++)o[n[u]]||(o[n[u]]=digitTest.test(n[u+1])||n[u+1]=="[]"?[]:{}),o=o[n[u]];r=n.pop(),r=="[]"?o.push(s):o[r]=s})),t}});var matcher=/\:([\w\.]+)/g,paramsMatcher=/^(?:&[^=]+=[^&]*)+/,makeProps=function(e){var t=[];return can.each(e,function(e,n){t.push((n==="className"?"class":n)+'="'+(n==="href"?e:can.esc(e))+'"')}),t.join(" ")},matchesData=function(e,t){var n=0,r=0,i={};for(var s in e.defaults)e.defaults[s]===t[s]&&(i[s]=1,n++);for(;r<e.names.length;r++){if(!t.hasOwnProperty(e.names[r]))return-1;i[e.names[r]]||n++}return n},onready=!0,location=window.location,wrapQuote=function(e){return(e+"").replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")},each=can.each,extend=can.extend;can.route=function(e,t){t=t||{};var n=[],r=e.replace(matcher,function(r,i,s){n.push(i);var o="\\"+(e.substr(s+r.length,1)||can.route._querySeparator);return"([^"+o+"]"+(t[i]?"*":"+")+")"});return can.route.routes[e]={test:new RegExp("^"+r+"($|"+wrapQuote(can.route._querySeparator)+")"),route:e,names:n,defaults:t,length:e.split("/").length},can.route},extend(can.route,{_querySeparator:"&",_paramsMatcher:paramsMatcher,param:function(e,t){var n,r=0,i,s=e.route,o=0;delete e.route,each(e,function(){o++}),each(can.route.routes,function(t,s){i=matchesData(t,e),i>r&&(n=t,r=i);if(i>=o)return!1}),can.route.routes[s]&&matchesData(can.route.routes[s],e)===r&&(n=can.route.routes[s]);if(n){var u=extend({},e),a=n.route.replace(matcher,function(t,r){return delete u[r],e[r]===n.defaults[r]?"":encodeURIComponent(e[r])}),f;return each(n.defaults,function(e,t){u[t]===e&&delete u[t]}),f=can.param(u),t&&can.route.attr("route",n.route),a+(f?can.route._querySeparator+f:"")}return can.isEmptyObject(e)?"":can.route._querySeparator+can.param(e)},deparam:function(e){var t={length:-1};each(can.route.routes,function(n,r){n.test.test(e)&&n.length>t.length&&(t=n)});if(t.length>-1){var n=e.match(t.test),r=n.shift(),i=e.substr(r.length-(n[n.length-1]===can.route._querySeparator?1:0)),s=i&&can.route._paramsMatcher.test(i)?can.deparam(i.slice(1)):{};return s=extend(!0,{},t.defaults,s),each(n,function(e,n){e&&e!==can.route._querySeparator&&(s[t.names[n]]=decodeURIComponent(e))}),s.route=t.route,s}return e.charAt(0)!==can.route._querySeparator&&(e=can.route._querySeparator+e),can.route._paramsMatcher.test(e)?can.deparam(e.slice(1)):{}},data:new can.Observe({}),routes:{},ready:function(e){e===!1&&(onready=e);if(e===!0||onready===!0)can.route._setup(),setState();return can.route},url:function(e,t){return t&&(e=extend({},curParams,e)),"#!"+can.route.param(e)},link:function(e,t,n,r){return"<a "+makeProps(extend({href:can.route.url(t,r)},n))+">"+e+"</a>"},current:function(e){return location.hash=="#!"+can.route.param(e)},_setup:function(){can.bind.call(window,"hashchange",setState)},_getHash:function(){return location.href.split(/#!?/)[1]||""},_setHash:function(e){var t=can.route.param(e,!0);return location.hash="#!"+t,t}}),each(["bind","unbind","delegate","undelegate","attr","removeAttr"],function(e){can.route[e]=function(){return can.route.data[e].apply(can.route.data,arguments)}});var timer,curParams,setState=can.route.setState=function(){var e=can.route._getHash();curParams=can.route.deparam(e),(!changingData||e!==lastHash)&&can.route.attr(curParams,!0)},lastHash,changingData;can.route.bind("change",function(e,t){changingData=1,clearTimeout(timer),timer=setTimeout(function(){changingData=0;var e=can.route.data.serialize();lastHash=can.route._setHash(e)},1)}),can.bind.call(document,"ready",can.route.ready),can.route.constructor.canMakeObserve=can.Observe.canMakeObserve;var bind=function(e,t,n){return can.bind.call(e,t,n),function(){can.unbind.call(e,t,n)}},isFunction=can.isFunction,extend=can.extend,each=can.each,slice=[].slice,paramReplacer=/\{([^\}]+)\}/g,special=can.getObject("$.event.special")||{},delegate=function(e,t,n,r){return can.delegate.call(e,t,n,r),function(){can.undelegate.call(e,t,n,r)}},binder=function(e,t,n,r){return r?delegate(e,can.trim(r),t,n):bind(e,t,n)},basicProcessor,Control=can.Control=can.Construct({setup:function(){can.Construct.setup.apply(this,arguments);if(can.Control){var e=this,t;e.actions={};for(t in e.prototype)e._isAction(t)&&(e.actions[t]=e._action(t))}},_shifter:function(e,t){var n=typeof t=="string"?e[t]:t;return isFunction(n)||(n=e[n]),function(){return e.called=t,n.apply(e,[this.nodeName?can.$(this):this].concat(slice.call(arguments,0)))}},_isAction:function(e){var t=this.prototype[e],n=typeof t;return e!=="constructor"&&(n=="function"||n=="string"&&isFunction(this.prototype[t]))&&!!(special[e]||processors[e]||/[^\w]/.test(e))},_action:function(e,t){paramReplacer.lastIndex=0;if(t||!paramReplacer.test(e)){var n=t?can.sub(e,[t,window]):e;if(!n)return null;var r=can.isArray(n),i=r?n[1]:n,s=i.split(/\s+/g),o=s.pop();return{processor:processors[o]||basicProcessor,parts:[i,s.join(" "),o],delegate:r?n[0]:undefined}}},processors:{},defaults:{}},{setup:function(e,t){var n=this.constructor,r=n.pluginName||n._fullName,i;return this.element=can.$(e),r&&r!=="can_control"&&this.element.addClass(r),(i=can.data(this.element,"controls"))||can.data(this.element,"controls",i=[]),i.push(this),this.options=extend({},n.defaults,t),this.on(),[this.element,this.options]},on:function(e,t,n,r){if(!e){this.off();var i=this.constructor,s=this._bindings,o=i.actions,u=this.element,a=can.Control._shifter(this,"destroy"),f,l;for(f in o)o.hasOwnProperty(f)&&(l=o[f]||i._action(f,this.options))&&s.push(l.processor(l.delegate||u,l.parts[2],l.parts[1],f,this));return can.bind.call(u,"destroyed",a),s.push(function(e){can.unbind.call(e,"destroyed",a)}),s.length}return typeof e=="string"&&(r=n,n=t,t=e,e=this.element),r===undefined&&(r=n,n=t,t=null),typeof r=="string"&&(r=can.Control._shifter(this,r)),this._bindings.push(binder(e,n,r,t)),this._bindings.length},off:function(){var e=this.element[0];each(this._bindings||[],function(t){t(e)}),this._bindings=[]},destroy:function(){var e=this.constructor,t=e.pluginName||e._fullName,n;this.off(),t&&t!=="can_control"&&this.element.removeClass(t),n=can.data(this.element,"controls"),n.splice(can.inArray(this,n),1),can.trigger(this,"destroyed"),this.element=null}}),processors=can.Control.processors,basicProcessor=function(e,t,n,r,i){return binder(e,t,can.Control._shifter(i,r),n)};each(["change","click","contextmenu","dblclick","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","reset","resize","scroll","select","submit","focusin","focusout","mouseenter","mouseleave","touchstart","touchmove","touchcancel","touchend","touchleave"],function(e){processors[e]=basicProcessor}),can.Control.processors.route=function(e,t,n,r,i){n=n||"",can.route(n);var s,o=function(e,t,o){if(can.route.attr("route")===n&&(e.batchNum===undefined||e.batchNum!==s)){s=e.batchNum;var u=can.route.attr();delete u.route,can.isFunction(i[r])?i[r](u):i[i[r]](u)}};return can.route.bind("change",o),function(){can.route.unbind("change",o)}};var isFunction=can.isFunction,makeArray=can.makeArray,hookupId=1,$view=can.view=function(e,t,n,r){var i=$view.render(e,t,n,r);return isFunction(i)?i:can.isDeferred(i)?i.pipe(function(e){return $view.frag(e)}):$view.frag(i)};can.extend($view,{frag:function(e,t){return $view.hookup($view.fragment(e),t)},fragment:function(e){var t=can.buildFragment(e,document.body);return t.childNodes.length||t.appendChild(document.createTextNode("")),t},toId:function(e){return can.map(e.toString().split(/\/|\./g),function(e){if(e)return e}).join("_")},hookup:function(e,t){var n=[],r,i;return can.each(e.childNodes?can.makeArray(e.childNodes):e,function(e){e.nodeType===1&&(n.push(e),n.push.apply(n,can.makeArray(e.getElementsByTagName("*"))))}),can.each(n,function(e){e.getAttribute&&(r=e.getAttribute("data-view-id"))&&(i=$view.hookups[r])&&(i(e,t,r),delete $view.hookups[r],e.removeAttribute("data-view-id"))}),e},hookups:{},hook:function(e){return $view.hookups[++hookupId]=e," data-view-id='"+hookupId+"'"},cached:{},cachedRenderers:{},cache:!0,register:function(e){this.types["."+e.suffix]=e},types:{},ext:".ejs",registerScript:function(){},preload:function(){},render:function(e,t,n,r){isFunction(n)&&(r=n,n=undefined);var i=getDeferreds(t);if(i.length){var s=new can.Deferred;return i.push(get(e,!0)),can.when.apply(can,i).then(function(e){var i=makeArray(arguments),o=i.pop(),u;if(can.isDeferred(t))t=usefulPart(e);else for(var a in t)can.isDeferred(t[a])&&(t[a]=usefulPart(i.shift()));u=o(t,n),s.resolve(u),r&&r(u)}),s}var o,u=isFunction(r),s=get(e,u);if(u)o=s,s.then(function(e){r(t?e(t,n):e)});else{if(s.state()==="resolved"&&s.__view_id){var a=$view.cachedRenderers[s.__view_id];return t?a(t,n):a}s.then(function(e){o=t?e(t,n):e})}return o},registerView:function(e,t,n,r){var i=(n||$view.types[$view.ext]).renderer(e,t);return r=r||new can.Deferred,$view.cache&&($view.cached[e]=r,r.__view_id=e,$view.cachedRenderers[e]=i),r.resolve(i)}});var checkText=function(e,t){if(!e.length)throw"can.view: No template or empty template:"+t},get=function(e,t){var n=e.match(/\.[\w\d]+$/),r,i,s,o;e.match(/^#/)&&(e=e.substr(1));if(i=document.getElementById(e))n="."+i.type.match(/\/(x\-)?(.+)/)[2];!n&&!$view.cached[e]&&(e+=n=$view.ext),can.isArray(n)&&(n=n[0]),s=$view.toId(e);if(e.match(/^\/\//)){var u=e.substr(2);e=window.steal?steal.config().root.mapJoin(u):u}r=$view.types[n];if($view.cached[s])return $view.cached[s];if(i)return $view.registerView(s,i.innerHTML,r);var a=new can.Deferred;return can.ajax({async:t,url:e,dataType:"text",error:function(t){checkText("",e),a.reject(t)},success:function(t){checkText(t,e),$view.registerView(s,t,r,a)}}),a},getDeferreds=function(e){var t=[];if(can.isDeferred(e))return[e];for(var n in e)can.isDeferred(e[n])&&t.push(e[n]);return t},usefulPart=function(e){return can.isArray(e)&&e[1]==="success"?e[0]:e};window.steal&&steal.type("view js",function(e,t,n){var r=$view.types["."+e.type],i=$view.toId(e.id);e.text="steal('"+(r.plugin||"can/view/"+e.type)+"',function(can){return "+"can.view.preload('"+i+"',"+e.text+");\n})",t()}),can.extend($view,{register:function(e){this.types["."+e.suffix]=e,window.steal&&steal.type(e.suffix+" view js",function(e,t,n){var r=$view.types["."+e.type],i=$view.toId(e.id+"");e.text=r.script(i,e.text),t()}),$view[e.suffix]=function(t,n){return n?($view.preload(t,e.renderer(t,n)),can.view(t)):e.renderer(null,t)}},registerScript:function(e,t,n){return"can.view.preload('"+t+"',"+$view.types["."+e].script(t,n)+");"},preload:function(e,t){return $view.cached[e]=(new can.Deferred).resolve(function(e,n){return t.call(e,e,n)}),function(){return $view.frag(t.apply(this,arguments))}}});var getValueAndObserved=function(e,t){var n;can.Observe&&(n=can.Observe.__reading,can.Observe.__reading=function(e,t){r.push({obj:e,attr:t})});var r=[],i=e.call(t);return can.Observe&&(can.Observe.__reading=n),{value:i,observed:r}},computeBinder=function(e,t,n){var r={},i=!0,s={value:undefined,teardown:function(){for(var e in r){var t=r[e];t.observe.obj.unbind(t.observe.attr,u),delete r[e]}}},o,u=function(e){if(e.batchNum===undefined||e.batchNum!==o){var t=s.value,r=a();s.value=r,r!==t&&n(r,t),o=o=e.batchNum}},a=function(){var n=getValueAndObserved(e,t),s=n.observed,o=n.value;i=!i,can.each(s,function(e){r[e.obj._cid+"|"+e.attr]?r[e.obj._cid+"|"+e.attr].matched=i:(r[e.obj._cid+"|"+e.attr]={matched:i,observe:e},e.obj.bind(e.attr,u))});for(var a in r){var f=r[a];f.matched!==i&&(f.observe.obj.unbind(f.observe.attr,u),delete r[a])}return o};return s.value=a(),s.isListening=!can.isEmptyObject(r),s};can.compute=function(e,t){if(e&&e.isComputed)return e;var n,r=0,i,s=!0;return typeof e=="function"?i=function(s){return s===undefined?n?(r&&can.Observe.__reading&&can.Observe.__reading(i,"change"),n.value):e.call(t||this):e.apply(t||this,arguments)}:(i=function(t){if(t===undefined)return can.Observe.__reading&&can.Observe.__reading(i,"change"),e;var n=e;return e=t,n!==t&&can.Observe.triggerBatch(i,"change",[t,n]),t},s=!1),i.isComputed=!0,i.bind=function(o,u){can.addEvent.apply(i,arguments),r===0&&s&&(n=computeBinder(e,t||this,function(e,t){can.Observe.triggerBatch(i,"change",[e,t])})),r++},i.unbind=function(e,t){can.removeEvent.apply(i,arguments),r--,r===0&&s&&n.teardown()},i},can.compute.binder=computeBinder;var newLine=/(\r|\n)+/g,tagToContentPropMap={option:"textContent",textarea:"value"},clean=function(e){return e.split("\\").join("\\\\").split("\n").join("\\n").split('"').join('\\"').split("	").join("\\t")},reverseTagMap={tr:"tbody",option:"select",td:"tr",li:"ul"},getTag=function(e,t,n){if(e)return e;while(n<t.length){if(t[n]=="<"&&reverseTagMap[t[n+1]])return reverseTagMap[t[n+1]];n++}},bracketNum=function(e){return--e.split("{").length- --e.split("}").length},myEval=function(script){eval(script)},attrReg=/([^\s]+)[\s]*=[\s]*$/,startTxt="var ___v1ew = [];",finishTxt="return ___v1ew.join('')",put_cmd="___v1ew.push(",insert_cmd=put_cmd,htmlTag=null,quote=null,beforeQuote=null,rescan=null,status=function(){return quote?"'"+beforeQuote.match(attrReg)[1]+"'":htmlTag?1:0};can.view.Scanner=Scanner=function(e){can.extend(this,{text:{},tokens:[]},e),this.tokenReg=[],this.tokenSimple={"<":"<",">":">",'"':'"',"'":"'"},this.tokenComplex=[],this.tokenMap={};for(var t=0,n;n=this.tokens[t];t++)n[2]?(this.tokenReg.push(n[2]),this.tokenComplex.push({abbr:n[1],re:new RegExp(n[2]),rescan:n[3]})):(this.tokenReg.push(n[1]),this.tokenSimple[n[1]]=n[0]),this.tokenMap[n[0]]=n[1];this.tokenReg=new RegExp("("+this.tokenReg.slice(0).concat(["<",">",'"',"'"]).join("|")+")","g")},Scanner.prototype={helpers:[{name:/\s*\(([\$\w]+)\)\s*->([^\n]*)/,fn:function(e){var t=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,n=e.match(t);return"function(__){var "+n[1]+"=can.$(__);"+n[2]+"}"}}],scan:function(e,t){var n=[],r=0,i=this.tokenSimple,s=this.tokenComplex;e=e.replace(newLine,"\n"),e.replace(this.tokenReg,function(t,o){var u=arguments[arguments.length-2];u>r&&n.push(e.substring(r,u));if(i[t])n.push(t);else for(var a=0,f;f=s[a];a++)if(f.re.test(t)){n.push(f.abbr),f.rescan&&n.push(f.rescan(o));break}r=u+o.length}),r<e.length&&n.push(e.substr(r));var o="",u=[startTxt+(this.text.start||"")],a=function(e,t){u.push(put_cmd,'"',clean(e),'"'+(t||"")+");")},f=[],l,c=null,h=!1,p="",d=[],v,m=0,g,y=this.tokenMap;htmlTag=quote=beforeQuote=null;for(;(g=n[m++])!==undefined;){if(c===null)switch(g){case y.left:case y.escapeLeft:case y.returnLeft:h=htmlTag&&1;case y.commentLeft:c=g,o.length&&a(o),o="";break;case y.escapeFull:h=htmlTag&&1,rescan=1,c=y.escapeLeft,o.length&&a(o),rescan=n[m++],o=rescan.content||rescan,rescan.before&&a(rescan.before),n.splice(m,0,y.right);break;case y.commentFull:break;case y.templateLeft:o+=y.left;break;case"<":n[m].indexOf("!--")!==0&&(htmlTag=1,h=0),o+=g;break;case">":htmlTag=0;var b=o.substr(o.length-1)=="/";h||tagToContentPropMap[d[d.length-1]]?(b?a(o.substr(0,o.length-1),',can.view.pending(),"/>"'):a(o,',can.view.pending(),">"'),o=""):o+=g,b&&(d.pop(),p=d[d.length-1]);break;case"'":case'"':htmlTag&&(quote&&quote===g?quote=null:quote===null&&(quote=g,beforeQuote=l));default:l==="<"&&(p=g.split(/\s/)[0],p.indexOf("/")===0&&d.pop()===p.substr(1)?p=d[d.length-1]:d.push(p)),o+=g}else switch(g){case y.right:case y.returnRight:switch(c){case y.left:v=bracketNum(o),v==1?(u.push(insert_cmd,"can.view.txt(0,'"+getTag(p,n,m)+"',"+status()+",this,function(){",startTxt,o),f.push({before:"",after:finishTxt+"}));\n"})):(r=f.length&&v==-1?f.pop():{after:";"},r.before&&u.push(r.before),u.push(o,";",r.after));break;case y.escapeLeft:case y.returnLeft:v=bracketNum(o),v&&f.push({before:finishTxt,after:"}));"});var w=c===y.escapeLeft?1:0,E={insert:insert_cmd,tagName:p,status:status()};for(var S=0;S<this.helpers.length;S++){var x=this.helpers[S];if(x.name.test(o)){o=x.fn(o,E),x.name.source==/^>[\s|\w]\w*/.source&&(w=0);break}}typeof o=="object"?o.raw&&u.push(o.raw):u.push(insert_cmd,"can.view.txt("+w+",'"+p+"',"+status()+",this,function(){ "+(this.text.escape||"")+"return ",o,v?startTxt:"}));"),rescan&&rescan.after&&rescan.after.length&&(a(rescan.after.length),rescan=null)}c=null,o="";break;case y.templateLeft:o+=y.left;break;default:o+=g}l=g}o.length&&a(o),u.push(";");var T=u.join(""),N={out:"with(_VIEW) { with (_CONTEXT) {"+T+" "+finishTxt+"}}"};return myEval.call(N,"this.fn = (function(_CONTEXT,_VIEW){"+N.out+"});\r\n//@ sourceURL="+t+".js"),N}};var canExpando=!0;try{document.createTextNode()._=0}catch(ex){canExpando=!1}var attrMap={"class":"className",value:"value",textContent:"textContent"},tagMap={"":"span",table:"tr",tr:"td",ol:"li",ul:"li",tbody:"tr",thead:"tr",tfoot:"tr",select:"option",optgroup:"option"},attributePlaceholder="__!!__",attributeReplace=/__!!__/g,tagToContentPropMap={option:"textContent",textarea:"value"},bool=can.each(["checked","disabled","readonly","required"],function(e){attrMap[e]=e}),getParentNode=function(e,t){return t&&e.parentNode.nodeType===11?t:e.parentNode},setAttr=function(e,t,n){var r=e.nodeName.toString().toLowerCase(),i=attrMap[t];i?(e[i]=can.inArray(t,bool)>-1?!0:n,i==="value"&&r==="input"&&(e.defaultValue=n)):e.setAttribute(t,n)},getAttr=function(e,t){return(attrMap[t]?e[attrMap[t]]:e.getAttribute(t))||""},removeAttr=function(e,t){can.inArray(t,bool)>-1?e[t]=!1:e.removeAttribute(t)},pendingHookups=[],contentText=function(e){if(typeof e=="string")return e;if(!e&&e!==0)return"";var t=e.hookup&&function(t,n){e.hookup.call(e,t,n)}||typeof e=="function"&&e;return t?(pendingHookups.push(t),""):""+e},contentEscape=function(e){return typeof e=="string"||typeof e=="number"?can.esc(e):contentText(e)},nodeMap={},textNodeMap={},nodeListMap={},expando="ejs_"+Math.random(),_id=0,id=function(e){if(canExpando||e.nodeType!==3)return e[expando]?e[expando]:e[expando]=(e.nodeName?"element_":"obj_")+ ++_id;for(var t in textNodeMap)if(textNodeMap[t]===e)return t;return textNodeMap["text_"+ ++_id]=e,"text_"+_id},removeNodeListId=function(e,t){var n=nodeMap[id(e)];if(n){var r=can.inArray(t,n);r>=0&&n.splice(r,1),n.length||delete nodeMap[id(e)]}},addNodeListId=function(e,t){var n=nodeMap[id(e)];n||(n=nodeMap[id(e)]=[]),n.push(t)},tagChildren=function(e){var t=tagMap[e]||"span";return t==="span"?"@@!!@@":"<"+t+">"+tagChildren(t)+"</"+t+">"};can.extend(can.view,{pending:function(){var e=pendingHookups.slice(0);return lastHookups=e,pendingHookups=[],can.view.hook(function(t){can.each(e,function(e){e(t)})})},registerNode:function(e){var t=id(e);nodeListMap[t]=e,can.each(e,function(e){addNodeListId(e,t)})},unregisterNode:function(e){var t=id(e);can.each(e,function(e){removeNodeListId(e,t)}),delete nodeListMap[t]},txt:function(e,t,n,r,i){var s=can.compute.binder(i,r,function(e,t){h(e,t)});if(!s.isListening)return(e||n!==0?contentEscape:contentText)(s.value);var o,u,a=function(){s.teardown(),u&&can.view.unregisterNode(u)},f=function(e){can.bind.call(e,"destroyed",a),o=e},l=function(e){e||(a(),can.unbind.call(o,"destroyed",a))},c=tagMap[t]||"span",h,p=tagToContentPropMap[t];if(n===0&&!p)return"<"+c+can.view.hook(e?function(e,t){h=function(e){r.nodeValue=""+e,l(r.parentNode)};var n=getParentNode(e,t),r=document.createTextNode(s.value);n.insertBefore(r,e),n.removeChild(e),f(n)}:function(e,t){h=function(e){var t=n[0].parentNode;t&&r(e),l(n[0].parentNode)},t=getParentNode(e,t);var n,r=function(r){var i=can.view.frag(r,t),s=can.makeArray(i.childNodes),o=n?n[n.length-1]:e;o.nextSibling?o.parentNode.insertBefore(i,o.nextSibling):o.parentNode.appendChild(i),n?(can.remove(can.$(n)),can.view.replace(n,s)):(can.remove(can.$(e)),n=s,u=n,can.view.registerNode(n))};r(s.value,[e]),f(t)})+">"+tagChildren(c)+"</"+c+">";if(n===1){var d=s.value.replace(/['"]/g,"").split("=")[0];return pendingHookups.push(function(e){h=function(t){var n=(t||"").replace(/['"]/g,"").split("="),r=n[0];r!=d&&d&&removeAttr(e,d),r&&(setAttr(e,r,n[1]),d=r)},f(e)}),s.value}var v=n===0?p:n;return(n===0?lastHookups:pendingHookups).push(function(e){h=function(){setAttr(e,v,u.render(),p)};var t=can.$(e),n;n=can.data(t,"hooks"),n||can.data(t,"hooks",n={});var r=getAttr(e,v,p),i=r.split(attributePlaceholder),o=[],u;o.push(i.shift(),i.join(attributePlaceholder)),n[v]?n[v].bindings.push(s):n[v]={render:function(){var e=0,t=r.replace(attributeReplace,function(){return contentText(u.bindings[e++].value)});return t},bindings:[s],batchNum:undefined},u=n[v],o.splice(1,0,s.value),setAttr(e,v,o.join(""),p),f(e)}),attributePlaceholder},replace:function(e,t){e=can.makeArray(e),can.each(e,function(n){can.each(can.makeArray(nodeMap[id(n)]),function(r){var i=nodeListMap[r],s=can.inArray(n,i),o=can.inArray(e[e.length-1],i);if(s>=0&&o>=0){for(var u=s;u<=o;u++){var a=i[u];removeNodeListId(a,r)}i.splice.apply(i,[s,o-s+1].concat(t)),can.each(t,function(e){addNodeListId(e,r)})}else can.view.unregisterNode(i)})})},canExpando:canExpando,textNodeMap:textNodeMap,nodeMap:nodeMap,nodeListMap:nodeListMap});var extend=can.extend,EJS=function(e){if(this.constructor!=EJS){var t=new EJS(e);return function(e,n){return t.render(e,n)}}if(typeof e=="function"){this.template={fn:e};return}extend(this,e),this.template=this.scanner.scan(this.text,this.name)};can.EJS=EJS,EJS.prototype.render=function(e,t){return e=e||{},this.template.fn.call(e,e,new EJS.Helpers(e,t||{}))},extend(EJS.prototype,{scanner:new can.view.Scanner({tokens:[["templateLeft","<%%"],["templateRight","%>"],["returnLeft","<%=="],["escapeLeft","<%="],["commentLeft","<%#"],["left","<%"],["right","%>"],["returnRight","%>"]]})}),EJS.Helpers=function(e,t){this._data=e,this._extras=t,extend(this,t)},EJS.Helpers.prototype={list:function(e,t){can.each(e,function(n,r){t(n,r,e)})}},can.view.register({suffix:"ejs",script:function(e,t){return"can.EJS(function(_CONTEXT,_VIEW) { "+(new EJS({text:t,name:e})).template.out+" })"},renderer:function(e,t){return EJS({text:t,name:e})}})}(this,jQuery),function(e,t,n){e.view.ext=".mustache";var r="___c0nt3xt",i="___h4sh",s="___st4ck",o=s+"("+r+",this)",u=function(t){return e.isFunction(t.attr)&&t.constructor&&!!t.constructor.canMakeObserve},a=function(e){return e&&e.splice&&typeof e.length=="number"},f=function(t){if(this.constructor!=f){var n=new f(t);return function(e){return n.render(e)}}if(typeof t=="function"){this.template={fn:t};return}e.extend(this,t),this.template=this.scanner.scan(this.text,this.name)};e.Mustache=t.Mustache=f,f.prototype.render=function(e,t){return e=e||{},this.template.fn.call(e,e,{_data:e})},e.extend(f.prototype,{scanner:new e.view.Scanner({text:{start:"var "+r+" = []; "+r+"."+s+" = true;"+"var "+s+" = function(context, self) {"+"var s;"+"if (arguments.length == 1 && context) {"+"s = !context."+s+" ? [context] : context;"+"} else {"+"s = context && context."+s+" ? context.concat([self]) : "+s+"(context).concat([self]);"+"}"+"return (s."+s+" = true) && s;"+"};"},tokens:[["returnLeft","{{{","{{[{&]"],["commentFull","{{!}}","^[\\s\\t]*{{!.+?}}\\n"],["commentLeft","{{!","(\\n[\\s\\t]*{{!|{{!)"],["escapeFull","{{}}","(^[\\s\\t]*{{[#/^][^}]+?}}\\n|\\n[\\s\\t]*{{[#/^][^}]+?}}\\n|\\n[\\s\\t]*{{[#/^][^}]+?}}$)",function(e){return{before:/^\n.+?\n$/.test(e)?"\n":"",content:e.match(/\{\{(.+?)\}\}/)[1]||""}}],["escapeLeft","{{"],["returnRight","}}}"],["right","}}"]],helpers:[{name:/^>[\s|\w]\w*/,fn:function(t,n){var r=e.trim(t.replace(/^>\s?/,""));return"can.view.render('"+r+"', "+o+".pop())"}},{name:/^\s?data\s/,fn:function(e,t){var n=e.replace(/(^\s?data\s)|(["'])/g,"");return"can.proxy(function(__){can.data(can.$(__),'"+n+"', this.pop()); }, "+o+")"}},{name:/^.*$/,fn:function(t,n){var s=!1,u=[];t=e.trim(t);if(t.length&&(s=t.match(/^([#^/]|else$)/))){s=s[0];switch(s){case"#":case"^":u.push(n.insert+"can.view.txt(0,'"+n.tagName+"',"+n.status+",this,function(){ return ");break;case"/":return{raw:'return ___v1ew.join("");}}])}));'}}t=t.substring(1)}if(s!="else"){var a=[],f=0,l=!1,c,h,p;(e.trim(t)+" ").replace(/((([^\s]+?=)?('.*?'|".*?"))|.*?)\s/g,function(e,t){a.push(t)}),u.push("can.Mustache.txt("+o+","+(s?'"'+s+'"':"null")+",");for(;c=a[f];f++)f&&u.push(","),f&&(p=c.match(/^(('.*?'|".*?"|[0-9.]+|true|false)|((.+?)=(('.*?'|".*?"|[0-9.]+|true|false)|(.+))))$/))?p[2]?u.push(p[0]):(l||(l=!0,u.push("{"+i+":{")),u.push(p[4],":",p[6]?p[6]:'can.Mustache.get("'+p[5].replace(/"/g,'\\"')+'",'+o+")"),f==a.length-1&&u.push("}}")):u.push('can.Mustache.get("'+c.replace(/"/g,'\\"')+'",'+o+(f==0&&a.length>1?",true":"")+")")}s&&s!="else"&&u.push(",[{_:function(){");switch(s){case"#":u.push('return ___v1ew.join("");}},{fn:function('+r+"){var ___v1ew = [];");break;case"else":case"^":u.push('return ___v1ew.join("");}},{inverse:function('+r+"){var ___v1ew = [];");break;default:u.push(");")}return u=u.join(""),s?{raw:u}:u}}]})});var l=e.view.Scanner.prototype.helpers;for(var c=0;c<l.length;c++)f.prototype.scanner.helpers.unshift(l[c]);f.txt=function(t,r,o){var u=Array.prototype.slice.call(arguments,3),l=e.extend.apply(e,[{fn:function(){},inverse:function(){}}].concat(r?u.pop():[])),c=u.length?u:[o],h=!0,p=[],d,v;if(r)for(d=0;d<c.length;d++)a(c[d])?h=r=="#"?h&&!!c[d].length:r=="^"?h&&!c[d].length:h:h=r=="#"?h&&!!c[d]:r=="^"?h&&!c[d]:h;if(v=f.getHelper(o)||e.isFunction(o)&&{fn:o}){var t=t[s]&&t[t.length-1]||t,m={fn:e.proxy(l.fn,t),inverse:e.proxy(l.inverse,t)},g=u[u.length-1];return g&&g[i]&&(m.hash=u.pop()[i]),u.push(m),v.fn.apply(t,u)||""}if(h)switch(r){case"#":if(a(o)){for(d=0;d<o.length;d++)p.push(l.fn.call(o[d]||{},t)||"");return p.join("")}return l.fn.call(o||{},t)||"";case"^":return l.inverse.call(o||{},t)||"";default:return""+(o!==n?o:"")}return""},f.get=function(t,r,i){var s=t.split("."),o=r[r.length-1],l=r[r.length-2],c,h,p,d,v;if(/^\.|this$/.test(t)){if(!/^object|undefined$/.test(typeof l))return l||"";while(h=r.pop())if(typeof h!="undefined")return h;return""}if(!i)for(d=r.length-1;d>=0;d--){h=r[d];if(h!==n)for(v=0;v<s.length;v++){if(typeof h[s[v]]=="undefined"){if(u(h)){c=h,p=s[v];break}c=h=n;break}c=h,h=h[p=s[v]]}if(h!==n)return e.isFunction(c[p])?c[p]():u(c)?c.attr(p):(u(h)&&a(h)&&h.attr("length"),h)}return o!==n&&e.isFunction(o[t])?o[t]:(h=f.getHelper(t))?t:""},f.registerHelper=function(e,t){this._helpers.push({name:e,fn:t})},f.getHelper=function(e){for(var t=0,n;n=this._helpers[t];t++)if(n.name==e)return n;return null},f._helpers=[{name:"if",fn:function(e,t){return e?t.fn(this):t.inverse(this)}},{name:"unless",fn:function(e,t){if(!e)return t.fn(this)}},{name:"each",fn:function(e,t){if(!!e&&e.length){var n=[];for(var r=0;r<e.length;r++)n.push(t.fn(e[r]));return n.join("")}}},{name:"with",fn:function(e,t){if(!!e)return t.fn(e)}}],e.view.register({suffix:"mustache",contentType:"x-mustache-template",script:function(e,t){return"can.Mustache(function(_CONTEXT,_VIEW) { "+(new f({text:t,name:e})).template.out+" })"},renderer:function(e,t){return f({text:t,name:e})}})}(can,this),can.Model("can.Model.LocalStorage",{localStore:function(e){var t=this.name,n=JSON.parse(window.localStorage[t]||(window.localStorage[t]="[]")),r=e.call(this,n);r!==!1&&(can.each(n,function(e){delete e.editing}),window.localStorage[t]=JSON.stringify(n))},findAll:function(e){var t=new can.Deferred;return this.localStore(function(e){var n=[],r=this;can.each(e,function(e){n.push(new r(e))}),t.resolve({data:n})}),t},destroy:function(e){var t=new can.Deferred;return this.localStore(function(n){for(var r=0;r<n.length;r++)if(n[r].id===e){n.splice(r,1);break}t.resolve({})}),t},create:function(e){var t=new can.Deferred;return this.localStore(function(t){e.id=e.id||parseInt(1e5*Math.random(),10),t.push(e)}),t.resolve({id:e.id}),t},update:function(e,t){var n=new can.Deferred,r;return this.localStore(function(n){for(var i=0;i<n.length;i++)if(n[i].id===e){r=n[i];break}can.extend(r,t)}),n.resolve({}),n}},{}),function(e,t){"use strict";var n=can.Model.LocalStorage({storageName:"todos-canjs"},{matches:function(){var e=can.route.attr("filter");return!e||e==="active"&&!this.attr("complete")||e==="completed"&&this.attr("complete")}});n.List=can.Model.List({completed:function(){var e=0;return this.each(function(t){e+=t.attr("complete")?1:0}),e},remaining:function(){return this.attr("length")-this.completed()},allComplete:function(){return this.attr("length")===this.completed()}}),e.Models=e.Models||{},e.Models.Todo=n}(this),function(e,t){"use strict";var n=13,r=can.Control({defaults:{view:"views/todos.ejs"}},{init:function(){this.element.append(can.view(this.options.view,this.options))},"#new-todo keyup":function(e,t){var r=can.trim(e.val());t.keyCode===n&&r!==""&&(new Models.Todo({text:r,complete:!1})).save(function(){e.val("")})},"{Models.Todo} created":function(e,t,n){this.options.todos.push(n),this.options.state.attr("filter","")},"{state} change":function(){this.element.find("#filters").find("a").removeClass("selected").end().find('[href="'+window.location.hash+'"]').addClass("selected")},".todo dblclick":function(e){e.data("todo").attr("editing",!0).save(function(){e.children(".edit").focus()})},updateTodo:function(e){var t=can.trim(e.val()),n=e.closest(".todo").data("todo");if(!n)return;t===""?n.destroy():n.attr({editing:!1,text:t}).save()},".todo .edit keyup":function(e,t){t.keyCode===n&&this.updateTodo(e)},".todo .edit focusout":"updateTodo",".todo .toggle click":function(e){e.closest(".todo").data("todo").attr("complete",e.is(":checked")).save()},".todo .destroy click":function(e){e.closest(".todo").data("todo").destroy()},"#toggle-all click":function(e){var t=e.prop("checked");can.each(this.options.todos,function(e){e.attr("complete",t).save()})},"#clear-completed click":function(){for(var e=this.options.todos.length-1,t;e>-1&&(t=this.options.todos[e]);e--)t.attr("complete")&&t.destroy()}});e.Todos=r}(this),function(){$(function(){$("body").append(can.view("views/app.ejs",{})),can.route(":filter"),can.route.ready(!1),Mustache.registerHelper("plural",function(e,t){return e+(t!==1?"s":"")}),Models.Todo.findAll({},function(e){new Todos("#todoapp",{todos:e,state:can.route,view:"views/todos.mustache"})}),can.route.ready(!0)})}(),function(window){can.view.preload("views_app_ejs",can.EJS(function(_CONTEXT,_VIEW){with(_VIEW)with(_CONTEXT){var ___v1ew=[];return ___v1ew.push('<section id="todoapp">\n</section>\n<div id="info">\n  <p>Double-click to edit a todo</p>\n  <p>Written by <a href="http://bitovi.com">Bitovi</a></p>\n  <p>Part of <a href="http://todomvc.com">TodoMVC</a></p>\n</div>'),___v1ew.join("")}})),can.view.preload("views_todos_mustache",can.Mustache(function(_CONTEXT,_VIEW){with(_VIEW)with(_CONTEXT){var ___v1ew=[],___c0nt3xt=[];___c0nt3xt.___st4ck=!0;var ___st4ck=function(e,t){var n;return arguments.length==1&&e?n=e.___st4ck?e:[e]:n=e&&e.___st4ck?e.concat([t]):___st4ck(e).concat([t]),(n.___st4ck=!0)&&n};return ___v1ew.push('<header id="header">\n  <h1>todos</h1>\n  <input id="new-todo" '),___v1ew.push(can.view.txt(1,"input",1,this,function(){return function(e){var t=can.$(e);t.val("").focus()}})),___v1ew.push(' placeholder="What needs to be done?" autofocus=""',can.view.pending(),">"),___v1ew.push('\n</header>\n<section id="main" class="'),___v1ew.push(can.view.txt(0,"section","class",this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"^",can.Mustache.get("todos",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{inverse:function(e){var t=[];return t.push("hidden"),t.join("")}}])})),___v1ew.push('"',can.view.pending(),">"),___v1ew.push('\n  <input id="toggle-all" type="checkbox" '),___v1ew.push(can.view.txt(0,"input",1,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"#",can.Mustache.get("todos.allComplete",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{fn:function(e){var t=[];return t.push('checked="checked"'),t.join("")}}])})),___v1ew.push("",can.view.pending(),">"),___v1ew.push('\n  <label for="toggle-all" >Mark all as complete</label>\n  <ul id="todo-list">'),___v1ew.push("\n"),___v1ew.push(can.view.txt(0,"ul",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"#",can.Mustache.get("todos",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{fn:function(e){var t=[];return t.push('    <li class="todo '),t.push(can.view.txt(0,"li","class",this,function(){return can.Mustache.txt(___st4ck(e,this),"^",can.Mustache.get("matches",___st4ck(e,this)),[{_:function(){return t.join("")}},{inverse:function(e){var t=[];return t.push("hidden"),t.join("")}}])})),t.push(" "),t.push(can.view.txt(0,"li","class",this,function(){return can.Mustache.txt(___st4ck(e,this),"#",can.Mustache.get("complete",___st4ck(e,this)),[{_:function(){return t.join("")}},{fn:function(e){var t=[];return t.push("completed"),t.join("")}}])})),t.push(" "),t.push(can.view.txt(0,"li","class",this,function(){return can.Mustache.txt(___st4ck(e,this),"#",can.Mustache.get("editing",___st4ck(e,this)),[{_:function(){return t.join("")}},{fn:function(e){var t=[];return t.push("editing"),t.join("")}}])})),t.push('" '),t.push(can.view.txt(1,"li",1,this,function(){return can.proxy(function(e){can.data(can.$(e),"todo",this.pop())},___st4ck(e,this))})),t.push("",can.view.pending(),">"),t.push('\n    <div class="view">\n      <input class="toggle" type="checkbox" '),t.push(can.view.txt(0,"input",1,this,function(){return can.Mustache.txt(___st4ck(e,this),"#",can.Mustache.get("complete",___st4ck(e,this)),[{_:function(){return t.join("")}},{fn:function(e){var t=[];return t.push('checked="checked"'),t.join("")}}])})),t.push("",can.view.pending(),">"),t.push("\n      <label>"),t.push(can.view.txt(1,"label",0,this,function(){return can.Mustache.txt(___st4ck(e,this),null,can.Mustache.get("text",___st4ck(e,this)))})),t.push('</label>\n      <button class="destroy"></button>\n    </div>\n    <input class="edit" type="text" value="'),t.push(can.view.txt(1,"input","value",this,function(){return can.Mustache.txt(___st4ck(e,this),null,can.Mustache.get("text",___st4ck(e,this)))})),t.push('"',can.view.pending(),">"),t.push("\n    </li>"),t.push("\n"),t.join("")}}])})),___v1ew.push('  </ul>\n</section>\n<footer id="footer" class="'),___v1ew.push(can.view.txt(0,"footer","class",this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"^",can.Mustache.get("todos",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{inverse:function(e){var t=[];return t.push("hidden"),t.join("")}}])})),___v1ew.push('"',can.view.pending(),">"),___v1ew.push('\n  <span id="todo-count">\n    <strong>'),___v1ew.push(can.view.txt(1,"strong",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),null,can.Mustache.get("todos.remaining",___st4ck(___c0nt3xt,this)))})),___v1ew.push("</strong> "),___v1ew.push(can.view.txt(1,"span",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),null,can.Mustache.get("plural",___st4ck(___c0nt3xt,this),!0),"item",can.Mustache.get("todos.remaining",___st4ck(___c0nt3xt,this)))})),___v1ew.push(' left\n  </span>\n  <ul id="filters">\n    <li>\n      <a class="selected" href="#!">All</a>\n    </li>\n    <li>\n      <a href="#!active">Active</a>\n    </li>\n    <li>\n      <a href="#!completed">Completed</a>\n    </li>\n  </ul>\n  <a href="#!" id="clear-completed" class="'),___v1ew.push(can.view.txt(0,"a","class",this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),"^",can.Mustache.get("todos.completed",___st4ck(___c0nt3xt,this)),[{_:function(){return ___v1ew.join("")}},{inverse:function(e){var t=[];return t.push("hidden"),t.join("")}}])})),___v1ew.push('"',can.view.pending(),">"),___v1ew.push("\n    Clear "),___v1ew.push(can.view.txt(1,"a",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),null,can.Mustache.get("todos.completed",___st4ck(___c0nt3xt,this)))})),___v1ew.push(" completed "),___v1ew.push(can.view.txt(1,"a",0,this,function(){return can.Mustache.txt(___st4ck(___c0nt3xt,this),null,can.Mustache.get("plural",___st4ck(___c0nt3xt,this),!0),"item",can.Mustache.get("todos.completed",___st4ck(___c0nt3xt,this)))})),___v1ew.push("\n  </a>\n</footer>"),___v1ew.join("")}}))}(this);